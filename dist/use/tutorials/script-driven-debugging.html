<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Breakpoint-Triggered Scripts" href="breakpoint-triggered-scripts.html" /><link rel="prev" title="Embedded Python Interpreter" href="python-embedded-interpreter.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2024.01.29 -->
        <title>Script-Driven Debugging - üêõ LLDB</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../../_static/lldb-setting.css?v=47390f8b" />
    
    


<style>
  body {
    --color-code-background: #f0f0f0;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">üêõ LLDB</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">üêõ LLDB</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Using LLDB</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../map.html">GDB to LLDB command map</a></li>
<li class="toctree-l1"><a class="reference internal" href="../formatting.html">Frame and Thread Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../variable.html">Variable Formatting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../symbolication.html">Symbolication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../symbols.html">Symbols on macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../remote.html">Remote Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intel_pt.html">Tracing with Intel Processor Trace</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ondemand.html">On Demand Symbols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aarch64-linux.html">Using LLDB On AArch64 Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../symbolfilejson.html">JSON Symbol File Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lldbdap.html">Getting started with <code class="docutils literal notranslate"><span class="pre">lldb-dap</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../mcp.html">Model Context Protocol (MCP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../settings.html">Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../links.html">Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../man/lldb.html">Man Page</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Scripting LLDB</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../python-reference.html">Python Reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Python Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="accessing-documentation.html">Accessing Script Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="python-embedded-interpreter.html">Embedded Python Interpreter</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Script-Driven Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="breakpoint-triggered-scripts.html">Breakpoint-Triggered Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="creating-custom-breakpoints.html">Custom Breakpoint Resolvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="automating-stepping-logic.html">Automating Stepping Logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="writing-custom-commands.html">Writing Custom Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="implementing-standalone-scripts.html">Implementing Standalone Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="custom-frame-recognizers.html">Detecting Patterns With Recognizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="extending-target-stop-hooks.html">Extending Target Stop-Hooks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../python_api.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python_extensions.html">Python Extensions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developing LLDB</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../resources/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/build.html">Building</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/test.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/qemu-testing.html">Testing LLDB using QEMU</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/fuzzing.html">Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/sbapi.html">Scripting Bridge API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/dataformatters.html">Data Formatters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/formatterbytecode.html">Formatter Bytecode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/extensions.html">DWARF Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/lldbgdbremote.html">GDB Remote Protocol Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/lldbplatformpackets.html">LLDB Platform Packets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/caveats.html">Caveats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/projects.html">Open Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/lldbdap-contributing.html">Contributing to LLDB-DAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/addinglanguagesupport.html">Adding Programming Language Support</a></li>
<li class="toctree-l1"><a class="reference external" href="https://lldb.llvm.org/cpp_reference/namespacelldb.html">Public C++ API</a></li>
<li class="toctree-l1"><a class="reference external" href="https://lldb.llvm.org/cpp_reference/index.html">Private C++ API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">External Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/llvm/llvm-project">Source Code</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/llvm/llvm-project/releases">Releases</a></li>
<li class="toctree-l1"><a class="reference external" href="https://discord.gg/xS7Z362">Join the Discord</a></li>
<li class="toctree-l1"><a class="reference external" href="https://discord.com/channels/636084430946959380/636732809708306432">Discord Channel</a></li>
<li class="toctree-l1"><a class="reference external" href="https://discourse.llvm.org/c/subprojects/lldb/8">Discussion Forums</a></li>
<li class="toctree-l1"><a class="reference external" href="https://llvm.org/docs/DeveloperPolicy.html">Developer Policy</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/llvm/llvm-project/issues?q=is%3Aissue+label%3Alldb+is%3Aopen">Bug Reports</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/llvm/llvm-project/pulls?q=is%3Apr+label%3Alldb+is%3Aopen">Code Reviews</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/llvm/llvm-project/edit/main/lldb/docs/use/tutorials/script-driven-debugging.md" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="script-driven-debugging">
<h1>Script-Driven Debugging<a class="headerlink" href="#script-driven-debugging" title="Link to this heading">#</a></h1>
<p>LLDB has been structured from the beginning to be scriptable in two
ways:</p>
<ul class="simple">
<li><p>a Unix Python session can initiate/run a debug session non-interactively
using LLDB;</p></li>
<li><p>and within the LLDB debugger tool, Python scripts can be used to help with
many tasks, including inspecting program data, iterating over containers and
determining if a breakpoint should stop execution or continue.</p></li>
</ul>
<p>This document will show how to do some of these things by going through an
example, explaining how to use Python scripting to find a bug in a program
that searches for text in a large binary tree.</p>
<section id="the-test-program-and-input">
<h2>The Test Program and Input<a class="headerlink" href="#the-test-program-and-input" title="Link to this heading">#</a></h2>
<p>We have a simple C program (<a class="reference external" href="https://github.com/llvm/llvm-project/blob/main/lldb/examples/scripting/dictionary.c">dictionary.c</a>)
that reads in a text file, and stores all the words from the file in a
Binary Search Tree, sorted alphabetically. It then enters a loop
prompting the user for a word, searching for the word in the tree
(using Binary Search), and reporting to the user whether or not it found
the word in the tree.</p>
<p>The input text file we are using to test our program contains the text
for William Shakespeare‚Äôs famous tragedy ‚ÄúRomeo and Juliet‚Äù.</p>
</section>
<section id="the-bug">
<h2>The Bug<a class="headerlink" href="#the-bug" title="Link to this heading">#</a></h2>
<p>When we try running our program, we find there is a problem. While it
successfully finds some of the words we would expect to find, such as
‚Äúlove‚Äù or ‚Äúsun‚Äù, it fails to find the word ‚ÄúRomeo‚Äù, which <strong>MUST</strong> be in
the input text file:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./dictionary<span class="w"> </span>Romeo-and-Juliet.txt
Dictionary<span class="w"> </span>loaded.
Enter<span class="w"> </span>search<span class="w"> </span>word:<span class="w"> </span>love
Yes!
Enter<span class="w"> </span>search<span class="w"> </span>word:<span class="w"> </span>sun
Yes!
Enter<span class="w"> </span>search<span class="w"> </span>word:<span class="w"> </span>Romeo
No!
Enter<span class="w"> </span>search<span class="w"> </span>word:<span class="w"> </span>^D
$
</pre></div>
</div>
</section>
<section id="using-depth-first-search">
<h2>Using Depth First Search<a class="headerlink" href="#using-depth-first-search" title="Link to this heading">#</a></h2>
<p>Our first job is to determine if the word ‚ÄúRomeo‚Äù actually got inserted
into the tree or not. Since ‚ÄúRomeo and Juliet‚Äù has thousands of words,
trying to examine our binary search tree by hand is completely
impractical. Therefore we will write a Python script to search the tree
for us. We will write a recursive Depth First Search function that
traverses the entire tree searching for a word, and maintaining
information about the path from the root of the tree to the current
node. If it finds the word in the tree, it returns the path from the
root to the node containing the word. This is what our DFS function in
Python would look like, with line numbers added for easy reference in
later explanations:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="p">:</span> <span class="k">def</span><span class="w"> </span><span class="nf">DFS</span> <span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">word</span><span class="p">,</span> <span class="n">cur_path</span><span class="p">):</span>
<span class="mi">2</span><span class="p">:</span>     <span class="n">root_word_ptr</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">GetChildMemberWithName</span> <span class="p">(</span><span class="s2">&quot;word&quot;</span><span class="p">)</span>
<span class="mi">3</span><span class="p">:</span>     <span class="n">left_child_ptr</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">GetChildMemberWithName</span> <span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="mi">4</span><span class="p">:</span>     <span class="n">right_child_ptr</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">GetChildMemberWithName</span> <span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="mi">5</span><span class="p">:</span>     <span class="n">root_word</span> <span class="o">=</span> <span class="n">root_word_ptr</span><span class="o">.</span><span class="n">GetSummary</span><span class="p">()</span>
<span class="mi">6</span><span class="p">:</span>     <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span> <span class="p">(</span><span class="n">root_word</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="mi">7</span><span class="p">:</span>     <span class="k">if</span> <span class="n">root_word</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span> <span class="ow">and</span> <span class="n">root_word</span><span class="p">[</span><span class="n">end</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">:</span>
<span class="mi">8</span><span class="p">:</span>         <span class="n">root_word</span> <span class="o">=</span> <span class="n">root_word</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">end</span><span class="p">]</span>
<span class="mi">9</span><span class="p">:</span>     <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span> <span class="p">(</span><span class="n">root_word</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="mi">10</span><span class="p">:</span>     <span class="k">if</span> <span class="n">root_word</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="ow">and</span> <span class="n">root_word</span><span class="p">[</span><span class="n">end</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">:</span>
<span class="mi">11</span><span class="p">:</span>        <span class="n">root_word</span> <span class="o">=</span> <span class="n">root_word</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">end</span><span class="p">]</span>
<span class="mi">12</span><span class="p">:</span>     <span class="k">if</span> <span class="n">root_word</span> <span class="o">==</span> <span class="n">word</span><span class="p">:</span>
<span class="mi">13</span><span class="p">:</span>         <span class="k">return</span> <span class="n">cur_path</span>
<span class="mi">14</span><span class="p">:</span>     <span class="k">elif</span> <span class="n">word</span> <span class="o">&lt;</span> <span class="n">root_word</span><span class="p">:</span>
<span class="mi">15</span><span class="p">:</span>         <span class="k">if</span> <span class="n">left_child_ptr</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="mi">16</span><span class="p">:</span>             <span class="k">return</span> <span class="s2">&quot;&quot;</span>
<span class="mi">17</span><span class="p">:</span>         <span class="k">else</span><span class="p">:</span>
<span class="mi">18</span><span class="p">:</span>             <span class="n">cur_path</span> <span class="o">=</span> <span class="n">cur_path</span> <span class="o">+</span> <span class="s2">&quot;L&quot;</span>
<span class="mi">19</span><span class="p">:</span>             <span class="k">return</span> <span class="n">DFS</span> <span class="p">(</span><span class="n">left_child_ptr</span><span class="p">,</span> <span class="n">word</span><span class="p">,</span> <span class="n">cur_path</span><span class="p">)</span>
<span class="mi">20</span><span class="p">:</span>     <span class="k">else</span><span class="p">:</span>
<span class="mi">21</span><span class="p">:</span>         <span class="k">if</span> <span class="n">right_child_ptr</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="mi">22</span><span class="p">:</span>             <span class="k">return</span> <span class="s2">&quot;&quot;</span>
<span class="mi">23</span><span class="p">:</span>         <span class="k">else</span><span class="p">:</span>
<span class="mi">24</span><span class="p">:</span>             <span class="n">cur_path</span> <span class="o">=</span> <span class="n">cur_path</span> <span class="o">+</span> <span class="s2">&quot;R&quot;</span>
<span class="mi">25</span><span class="p">:</span>             <span class="k">return</span> <span class="n">DFS</span> <span class="p">(</span><span class="n">right_child_ptr</span><span class="p">,</span> <span class="n">word</span><span class="p">,</span> <span class="n">cur_path</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="accessing-manipulating-program-variables">
<h2>Accessing &amp; Manipulating Program Variables<a class="headerlink" href="#accessing-manipulating-program-variables" title="Link to this heading">#</a></h2>
<p>Before we can call any Python function on any of our program‚Äôs
variables, we need to get the variable into a form that Python can
access. To show you how to do this we will look at the parameters for
the DFS function. The first parameter is going to be a node in our
binary search tree, put into a Python variable. The second parameter is
the word we are searching for (a string), and the third parameter is a
string representing the path from the root of the tree to our current
node.</p>
<p>The most interesting parameter is the first one, the Python variable
that needs to contain a node in our search tree. How can we take a
variable out of our program and put it into a Python variable? What
kind of Python variable will it be? The answers are to use the LLDB API
functions, provided as part of the LLDB Python module. Running Python
from inside LLDB, LLDB will automatically give us our current frame
object as a Python variable, ‚Äúlldb.frame‚Äù. This variable has the type
<code class="docutils literal notranslate"><span class="pre">SBFrame</span></code> (see the LLDB API for more information about <code class="docutils literal notranslate"><span class="pre">SBFrame</span></code>
objects). One of the things we can do with a frame object, is to ask it
to find and return its local variable. We will call the API function
<code class="docutils literal notranslate"><span class="pre">SBFrame.FindVariable</span></code> on the <code class="docutils literal notranslate"><span class="pre">lldb.frame</span></code> object to give us our
dictionary variable as a Python variable:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">root</span> <span class="o">=</span> <span class="n">lldb</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">FindVariable</span> <span class="p">(</span><span class="s2">&quot;dictionary&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The line above, executed in the Python script interpreter in LLDB, asks the
current frame to find the variable named ‚Äúdictionary‚Äù and return it. We then
store the returned value in the Python variable named ‚Äúroot‚Äù. This answers the
question of HOW to get the variable, but it still doesn‚Äôt explain WHAT actually
gets put into ‚Äúroot‚Äù. If you examine the LLDB API, you will find that the
<code class="docutils literal notranslate"><span class="pre">SBFrame</span></code> method ‚ÄúFindVariable‚Äù returns an object of type <code class="docutils literal notranslate"><span class="pre">SBValue</span></code>. <code class="docutils literal notranslate"><span class="pre">SBValue</span></code>
objects are used, among other things, to wrap up program variables and values.
There are many useful methods defined in the <code class="docutils literal notranslate"><span class="pre">SBValue</span></code> class to allow you to get
information or children values out of SBValues. For complete information, see
the header file SBValue.h. The <code class="docutils literal notranslate"><span class="pre">SBValue</span></code> methods that we use in our DFS function
are <code class="docutils literal notranslate"><span class="pre">GetChildMemberWithName()</span></code>, <code class="docutils literal notranslate"><span class="pre">GetSummary()</span></code>, and <code class="docutils literal notranslate"><span class="pre">GetValue()</span></code>.</p>
</section>
<section id="explaining-dfs-script-in-detail">
<h2>Explaining DFS Script in Detail<a class="headerlink" href="#explaining-dfs-script-in-detail" title="Link to this heading">#</a></h2>
<p>Before diving into the details of this code, it would be best to give a
high-level overview of what it does. The nodes in our binary search tree were
defined to have type <code class="docutils literal notranslate"><span class="pre">tree_node</span> <span class="pre">*</span></code>, which is defined as:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">tree_node</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">word</span><span class="p">;</span>
<span class="w">   </span><span class="k">struct</span><span class="w"> </span><span class="nc">tree_node</span><span class="w"> </span><span class="o">*</span><span class="n">left</span><span class="p">;</span>
<span class="w">   </span><span class="k">struct</span><span class="w"> </span><span class="nc">tree_node</span><span class="w"> </span><span class="o">*</span><span class="n">right</span><span class="p">;</span>
<span class="p">}</span><span class="w"> </span><span class="n">tree_node</span><span class="p">;</span>
</pre></div>
</div>
<p>Lines 2-11 of DFS are getting data out of the current tree node and getting
ready to do the actual search; lines 12-25 are the actual depth-first search.
Lines 2-4 of our DFS function get the word, left and right fields out of the
current node and store them in Python variables. Since root_word_ptr is a
pointer to our word, and we want the actual word, line 5 calls GetSummary() to
get a string containing the value out of the pointer. Since GetSummary() adds
quotes around its result, lines 6-11 strip surrounding quotes off the word.</p>
<p>Line 12 checks to see if the word in the current node is the one we are
searching for. If so, we are done, and line 13 returns the current path.
Otherwise, line 14 checks to see if we should go left (search word comes before
the current word). If we decide to go left, line 15 checks to see if the left
pointer child is NULL (‚ÄúNone‚Äù is the Python equivalent of NULL). If the left
pointer is NULL, then the word is not in this tree and we return an empty path
(line 16). Otherwise, we add an ‚ÄúL‚Äù to the end of our current path string, to
indicate we are going left (line 18), and then recurse on the left child (line
19). Lines 20-25 are the same as lines 14-19, except for going right rather
than going left.</p>
<p>One other note: Typing something as long as our DFS function directly into the
interpreter can be difficult, as making a single typing mistake means having to
start all over. Therefore we recommend doing as we have done: Writing your
longer, more complicated script functions in a separate file (in this case
tree_utils.py) and then importing it into your LLDB Python interpreter.</p>
</section>
<section id="the-dfs-script-in-action">
<h2>The DFS Script in Action<a class="headerlink" href="#the-dfs-script-in-action" title="Link to this heading">#</a></h2>
<p>At this point we are ready to use the DFS function to see if the word ‚ÄúRomeo‚Äù
is in our tree or not. To actually use it in LLDB on our dictionary program,
you would do something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ lldb
(lldb) process attach -n &quot;dictionary&quot;
Architecture set to: x86_64.
Process 521 stopped
* thread #1: tid = 0x2c03, 0x00007fff86c8bea0 libSystem.B.dylib`read$NOCANCEL + 8, stop reason = signal SIGSTOP
frame #0: 0x00007fff86c8bea0 libSystem.B.dylib`read$NOCANCEL + 8
(lldb) breakpoint set -n find_word
Breakpoint created: 1: name = &#39;find_word&#39;, locations = 1, resolved = 1
(lldb) continue
Process 521 resuming
Process 521 stopped
* thread #1: tid = 0x2c03, 0x0000000100001830 dictionary`find_word + 16
at dictionary.c:105, stop reason = breakpoint 1.1
frame #0: 0x0000000100001830 dictionary`find_word + 16 at dictionary.c:105
102 int
103 find_word (tree_node *dictionary, char *word)
104 {
-&gt; 105 if (!word || !dictionary)
106 return 0;
107
108 int compare_value = strcmp (word, dictionary-&gt;word);
(lldb) script
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">Python</span> <span class="n">Interactive</span> <span class="n">Interpreter</span><span class="o">.</span> <span class="n">To</span> <span class="n">exit</span><span class="p">,</span> <span class="nb">type</span> <span class="s1">&#39;quit()&#39;</span><span class="p">,</span> <span class="s1">&#39;exit()&#39;</span> <span class="ow">or</span> <span class="n">Ctrl</span><span class="o">-</span><span class="n">D</span><span class="o">.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">tree_utils</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">lldb</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">FindVariable</span> <span class="p">(</span><span class="s2">&quot;dictionary&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">current_path</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">path</span> <span class="o">=</span> <span class="n">tree_utils</span><span class="o">.</span><span class="n">DFS</span> <span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="s2">&quot;Romeo&quot;</span><span class="p">,</span> <span class="n">current_path</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="n">path</span>
<span class="n">LLRRL</span>
<span class="o">&gt;&gt;&gt;</span> <span class="o">^</span><span class="n">D</span>
<span class="p">(</span><span class="n">lldb</span><span class="p">)</span>
</pre></div>
</div>
<p>The first bit of code above shows starting lldb, attaching to the dictionary
program, and getting to the find_word function in LLDB. The interesting part
(as far as this example is concerned) begins when we enter the script command
and drop into the embedded interactive Python interpreter. We will go over this
Python code line by line. The first line</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">tree_utils</span>
</pre></div>
</div>
<p>imports the file where we wrote our DFS function, tree_utils.py, into Python.
Notice that to import the file we leave off the ‚Äú.py‚Äù extension. We can now
call any function in that file, giving it the prefix ‚Äútree_utils.‚Äù, so that
Python knows where to look for the function. The line</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">root</span> <span class="o">=</span> <span class="n">lldb</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">FindVariable</span> <span class="p">(</span><span class="s2">&quot;dictionary&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>gets our program variable ‚Äúdictionary‚Äù (which contains the binary search tree)
and puts it into the Python variable ‚Äúroot‚Äù. See Accessing &amp; Manipulating
Program Variables in Python above for more details about how this works. The
next line is</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">current_path</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</pre></div>
</div>
<p>This line initializes the current_path from the root of the tree to our current
node. Since we are starting at the root of the tree, our current path starts as
an empty string. As we go right and left through the tree, the DFS function
will append an ‚ÄòR‚Äô or an ‚ÄòL‚Äô to the current path, as appropriate. The line</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">tree_utils</span><span class="o">.</span><span class="n">DFS</span> <span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="s2">&quot;Romeo&quot;</span><span class="p">,</span> <span class="n">current_path</span><span class="p">)</span>
</pre></div>
</div>
<p>calls our DFS function (prefixing it with the module name so that Python can
find it). We pass in our binary tree stored in the variable root, the word we
are searching for, and our current path. We assign whatever path the DFS
function returns to the Python variable path.</p>
<p>Finally, we want to see if the word was found or not, and if so we want to see
the path through the tree to the word. So we do</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="n">path</span>
</pre></div>
</div>
<p>From this we can see that the word ‚ÄúRomeo‚Äù was indeed found in the tree, and
the path from the root of the tree to the node containing ‚ÄúRomeo‚Äù is
left-left-right-right-left.</p>
</section>
<section id="using-breakpoint-command-scripts">
<h2>Using Breakpoint Command Scripts<a class="headerlink" href="#using-breakpoint-command-scripts" title="Link to this heading">#</a></h2>
<p>We are halfway to figuring out what the problem is. We know the word we are
looking for is in the binary tree, and we know exactly where it is in the
binary tree. Now we need to figure out why our binary search algorithm is not
finding the word. We will do this using breakpoint command scripts.</p>
<p>The idea is as follows. The binary search algorithm has two main decision
points: the decision to follow the right branch; and, the decision to follow
the left branch. We will set a breakpoint at each of these decision points, and
attach a Python breakpoint command script to each breakpoint. The breakpoint
commands will use the global path Python variable that we got from our DFS
function. Each time one of these decision breakpoints is hit, the script will
compare the actual decision with the decision the front of the path variable
says should be made (the first character of the path). If the actual decision
and the path agree, then the front character is stripped off the path, and
execution is resumed. In this case the user never even sees the breakpoint
being hit. But if the decision differs from what the path says it should be,
then the script prints out a message and does NOT resume execution, leaving the
user sitting at the first point where a wrong decision is being made.</p>
</section>
<section id="python-breakpoint-command-scripts-are-not-what-they-seem">
<h2>Python Breakpoint Command Scripts Are Not What They Seem<a class="headerlink" href="#python-breakpoint-command-scripts-are-not-what-they-seem" title="Link to this heading">#</a></h2>
<p>What do we mean by that? When you enter a Python breakpoint command in LLDB, it
appears that you are entering one or more plain lines of Python. BUT LLDB then
takes what you entered and wraps it into a Python FUNCTION (just like using the
‚Äúdef‚Äù Python command). It automatically gives the function an obscure, unique,
hard-to-stumble-across function name, and gives it two parameters: frame and
bp_loc. When the breakpoint gets hit, LLDB wraps up the frame object where the
breakpoint was hit, and the breakpoint location object for the breakpoint that
was hit, and puts them into Python variables for you. It then calls the Python
function that was created for the breakpoint command, and passes in the frame
and breakpoint location objects.</p>
<p>So, being practical, what does this mean for you when you write your Python
breakpoint commands? It means that there are two things you need to keep in
mind: 1. If you want to access any Python variables created outside your
script, you must declare such variables to be global. If you do not declare
them as global, then the Python function will treat them as local variables,
and you will get unexpected behavior. 2. All Python breakpoint command scripts
automatically have a frame and a bp_loc variable. The variables are pre-loaded
by LLDB with the correct context for the breakpoint. You do not have to use
these variables, but they are there if you want them.</p>
</section>
<section id="the-decision-point-breakpoint-commands">
<h2>The Decision Point Breakpoint Commands<a class="headerlink" href="#the-decision-point-breakpoint-commands" title="Link to this heading">#</a></h2>
<p>This is what the Python breakpoint command script would look like for the
decision to go right:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">global</span> <span class="n">path</span>
<span class="k">if</span> <span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;R&#39;</span><span class="p">:</span>
   <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
   <span class="n">thread</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">GetThread</span><span class="p">()</span>
   <span class="n">process</span> <span class="o">=</span> <span class="n">thread</span><span class="o">.</span><span class="n">GetProcess</span><span class="p">()</span>
   <span class="n">process</span><span class="o">.</span><span class="n">Continue</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
   <span class="nb">print</span> <span class="s2">&quot;Here is the problem; going right, should go left!&quot;</span>
</pre></div>
</div>
<p>Just as a reminder, LLDB is going to take this script and wrap it up in a function, like this:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">some_unique_and_obscure_function_name</span> <span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">bp_loc</span><span class="p">):</span>
   <span class="k">global</span> <span class="n">path</span>
   <span class="k">if</span> <span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;R&#39;</span><span class="p">:</span>
      <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
      <span class="n">thread</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">GetThread</span><span class="p">()</span>
      <span class="n">process</span> <span class="o">=</span> <span class="n">thread</span><span class="o">.</span><span class="n">GetProcess</span><span class="p">()</span>
      <span class="n">process</span><span class="o">.</span><span class="n">Continue</span><span class="p">()</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="nb">print</span> <span class="s2">&quot;Here is the problem; going right, should go left!&quot;</span>
</pre></div>
</div>
<p>LLDB will call the function, passing in the correct frame and breakpoint
location whenever the breakpoint gets hit. There are several things to notice
about this function. The first one is that we are accessing and updating a
piece of state (the path variable), and actually conditioning our behavior
based upon this variable. Since the variable was defined outside of our script
(and therefore outside of the corresponding function) we need to tell Python
that we are accessing a global variable. That is what the first line of the
script does. Next we check where the path says we should go and compare it to
our decision (recall that we are at the breakpoint for the decision to go
right). If the path agrees with our decision, then we strip the first character
off of the path.</p>
<p>Since the decision matched the path, we want to resume execution. To do this we
make use of the frame parameter that LLDB guarantees will be there for us. We
use LLDB API functions to get the current thread from the current frame, and
then to get the process from the thread. Once we have the process, we tell it
to resume execution (using the Continue() API function).</p>
<p>If the decision to go right does not agree with the path, then we do not resume
execution. We allow the breakpoint to remain stopped (by doing nothing), and we
print an informational message telling the user we have found the problem, and
what the problem is.</p>
</section>
<section id="actually-using-the-breakpoint-commands">
<h2>Actually Using The Breakpoint Commands<a class="headerlink" href="#actually-using-the-breakpoint-commands" title="Link to this heading">#</a></h2>
<p>Now we will look at what happens when we actually use these breakpoint commands
on our program. Doing a source list -n find_word shows us the function
containing our two decision points. Looking at the code below, we see that we
want to set our breakpoints on lines 113 and 115:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">lldb</span><span class="p">)</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="n">find_word</span>
<span class="nl">File</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">Volumes</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">HD2</span><span class="o">/</span><span class="n">carolinetice</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">LLDB</span><span class="o">-</span><span class="n">Web</span><span class="o">-</span><span class="n">Examples</span><span class="o">/</span><span class="n">dictionary</span><span class="p">.</span><span class="n">c</span><span class="p">.</span>
<span class="mi">101</span>
<span class="mi">102</span><span class="w"> </span><span class="kt">int</span>
<span class="mi">103</span><span class="w"> </span><span class="n">find_word</span><span class="w"> </span><span class="p">(</span><span class="n">tree_node</span><span class="w"> </span><span class="o">*</span><span class="n">dictionary</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">word</span><span class="p">)</span>
<span class="mi">104</span><span class="w"> </span><span class="p">{</span>
<span class="mi">105</span><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">word</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="n">dictionary</span><span class="p">)</span>
<span class="mi">106</span><span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="mi">107</span>
<span class="mi">108</span><span class="w">   </span><span class="kt">int</span><span class="w"> </span><span class="n">compare_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">word</span><span class="p">,</span><span class="w"> </span><span class="n">dictionary</span><span class="o">-&gt;</span><span class="n">word</span><span class="p">);</span>
<span class="mi">109</span>
<span class="mi">110</span><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compare_value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="mi">111</span><span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="mi">112</span><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compare_value</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="mi">113</span><span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="n">find_word</span><span class="w"> </span><span class="p">(</span><span class="n">dictionary</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="n">word</span><span class="p">);</span>
<span class="mi">114</span><span class="w">   </span><span class="k">else</span>
<span class="mi">115</span><span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="n">find_word</span><span class="w"> </span><span class="p">(</span><span class="n">dictionary</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">,</span><span class="w"> </span><span class="n">word</span><span class="p">);</span>
<span class="mi">116</span><span class="w"> </span><span class="p">}</span>
<span class="mi">117</span>
</pre></div>
</div>
<p>So, we set our breakpoints, enter our breakpoint command scripts, and see what happens:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">lldb</span><span class="p">)</span><span class="w"> </span><span class="n">breakpoint</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="mi">113</span>
<span class="n">Breakpoint</span><span class="w"> </span><span class="n">created</span><span class="o">:</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="s">&quot;dictionary.c&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">113</span><span class="p">,</span><span class="w"> </span><span class="n">locations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">resolved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="p">(</span><span class="n">lldb</span><span class="p">)</span><span class="w"> </span><span class="n">breakpoint</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="mi">115</span>
<span class="n">Breakpoint</span><span class="w"> </span><span class="n">created</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="s">&quot;dictionary.c&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">115</span><span class="p">,</span><span class="w"> </span><span class="n">locations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">resolved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="p">(</span><span class="n">lldb</span><span class="p">)</span><span class="w"> </span><span class="n">breakpoint</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="n">python</span><span class="w"> </span><span class="mi">2</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">Enter</span> <span class="n">your</span> <span class="n">Python</span> <span class="n">command</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span> <span class="n">Type</span> <span class="s1">&#39;DONE&#39;</span> <span class="n">to</span> <span class="n">end</span><span class="o">.</span>
<span class="o">&gt;</span> <span class="k">global</span> <span class="n">path</span>
<span class="o">&gt;</span> <span class="k">if</span> <span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;L&#39;</span><span class="p">):</span>
<span class="o">&gt;</span>     <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="o">&gt;</span>     <span class="n">thread</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">GetThread</span><span class="p">()</span>
<span class="o">&gt;</span>     <span class="n">process</span> <span class="o">=</span> <span class="n">thread</span><span class="o">.</span><span class="n">GetProcess</span><span class="p">()</span>
<span class="o">&gt;</span>     <span class="n">process</span><span class="o">.</span><span class="n">Continue</span><span class="p">()</span>
<span class="o">&gt;</span> <span class="k">else</span><span class="p">:</span>
<span class="o">&gt;</span>     <span class="nb">print</span> <span class="s2">&quot;Here is the problem. Going left, should go right!&quot;</span>
<span class="o">&gt;</span> <span class="n">DONE</span>
</pre></div>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">lldb</span><span class="p">)</span><span class="w"> </span><span class="n">breakpoint</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="n">python</span><span class="w"> </span><span class="mi">3</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">Enter</span> <span class="n">your</span> <span class="n">Python</span> <span class="n">command</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span> <span class="n">Type</span> <span class="s1">&#39;DONE&#39;</span> <span class="n">to</span> <span class="n">end</span><span class="o">.</span>
<span class="o">&gt;</span> <span class="k">global</span> <span class="n">path</span>
<span class="o">&gt;</span> <span class="k">if</span> <span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;R&#39;</span><span class="p">):</span>
<span class="o">&gt;</span>     <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="o">&gt;</span>     <span class="n">thread</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">GetThread</span><span class="p">()</span>
<span class="o">&gt;</span>     <span class="n">process</span> <span class="o">=</span> <span class="n">thread</span><span class="o">.</span><span class="n">GetProcess</span><span class="p">()</span>
<span class="o">&gt;</span>     <span class="n">process</span><span class="o">.</span><span class="n">Continue</span><span class="p">()</span>
<span class="o">&gt;</span> <span class="k">else</span><span class="p">:</span>
<span class="o">&gt;</span>     <span class="nb">print</span> <span class="s2">&quot;Here is the problem. Going right, should go left!&quot;</span>
<span class="o">&gt;</span> <span class="n">DONE</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(lldb) continue
Process 696 resuming
Here is the problem. Going right, should go left!
Process 696 stopped
* thread #1: tid = 0x2d03, 0x000000010000189f dictionary`find_word + 127 at dictionary.c:115, stop reason = breakpoint 3.1
frame #0: 0x000000010000189f dictionary`find_word + 127 at dictionary.c:115
   112   else if (compare_value &lt; 0)
   113     return find_word (dictionary-&gt;left, word);
   114   else
-&gt; 115     return find_word (dictionary-&gt;right, word);
   116 }
   117
   118 void
(lldb)
</pre></div>
</div>
<p>After setting our breakpoints, adding our breakpoint commands and continuing,
we run for a little bit and then hit one of our breakpoints, printing out the
error message from the breakpoint command. Apparently at this point in the
tree, our search algorithm decided to go right, but our path says the node we
want is to the left. Examining the word at the node where we stopped, and our
search word, we see:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">lldb</span><span class="p">)</span><span class="w"> </span><span class="n">expr</span><span class="w"> </span><span class="n">dictionary</span><span class="o">-&gt;</span><span class="n">word</span>
<span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">$1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0000000100100080</span><span class="w"> </span><span class="s">&quot;dramatis&quot;</span>
<span class="p">(</span><span class="n">lldb</span><span class="p">)</span><span class="w"> </span><span class="n">expr</span><span class="w"> </span><span class="n">word</span>
<span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">$2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x00007fff5fbff108</span><span class="w"> </span><span class="s">&quot;romeo&quot;</span>
</pre></div>
</div>
<p>So the word at our current node is ‚Äúdramatis‚Äù, and the word we are searching
for is ‚Äúromeo‚Äù. ‚Äúromeo‚Äù comes after ‚Äúdramatis‚Äù alphabetically, so it seems like
going right would be the correct decision. Let‚Äôs ask Python what it thinks the
path from the current node to our word is:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">lldb</span><span class="p">)</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">path</span>
<span class="n">LLRRL</span>
</pre></div>
</div>
<p>According to Python we need to go left-left-right-right-left from our current
node to find the word we are looking for. Let‚Äôs double check our tree, and see
what word it has at that node:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">lldb</span><span class="p">)</span><span class="w"> </span><span class="n">expr</span><span class="w"> </span><span class="n">dictionary</span><span class="o">-&gt;</span><span class="n">left</span><span class="o">-&gt;</span><span class="n">left</span><span class="o">-&gt;</span><span class="n">right</span><span class="o">-&gt;</span><span class="n">right</span><span class="o">-&gt;</span><span class="n">left</span><span class="o">-&gt;</span><span class="n">word</span>
<span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">$4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0000000100100880</span><span class="w"> </span><span class="s">&quot;Romeo&quot;</span>
</pre></div>
</div>
<p>So the word we are searching for is ‚Äúromeo‚Äù and the word at our DFS location is
‚ÄúRomeo‚Äù. Aha! One is uppercase and the other is lowercase: We seem to have a
case conversion problem somewhere in our program (we do).</p>
<p>This is the end of our example on how you might use Python scripting in LLDB to
help you find bugs in your program.</p>
</section>
<section id="sources">
<h2>Sources<a class="headerlink" href="#sources" title="Link to this heading">#</a></h2>
<p>The complete code for the Dictionary program (with case-conversion bug), the
DFS function and other Python script examples used for this example are
available below.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/llvm/llvm-project/blob/main/lldb/examples/scripting/tree_utils.py">tree_utils.py</a> - Example Python functions using LLDB‚Äôs API, including DFS</p></li>
<li><p><a class="reference external" href="https://github.com/llvm/llvm-project/blob/main/lldb/examples/scripting/dictionary.c">dictionary.c</a> - Sample dictionary program, with bug</p></li>
<li><p>The text for ‚ÄúRomeo and Juliet‚Äù can be obtained from <a class="reference external" href="https://www.gutenberg.org">the Gutenberg Project</a>.</p></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="breakpoint-triggered-scripts.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Breakpoint-Triggered Scripts</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="python-embedded-interpreter.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Embedded Python Interpreter</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2007-2026, The LLDB Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Feb 10, 2026</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Script-Driven Debugging</a><ul>
<li><a class="reference internal" href="#the-test-program-and-input">The Test Program and Input</a></li>
<li><a class="reference internal" href="#the-bug">The Bug</a></li>
<li><a class="reference internal" href="#using-depth-first-search">Using Depth First Search</a></li>
<li><a class="reference internal" href="#accessing-manipulating-program-variables">Accessing &amp; Manipulating Program Variables</a></li>
<li><a class="reference internal" href="#explaining-dfs-script-in-detail">Explaining DFS Script in Detail</a></li>
<li><a class="reference internal" href="#the-dfs-script-in-action">The DFS Script in Action</a></li>
<li><a class="reference internal" href="#using-breakpoint-command-scripts">Using Breakpoint Command Scripts</a></li>
<li><a class="reference internal" href="#python-breakpoint-command-scripts-are-not-what-they-seem">Python Breakpoint Command Scripts Are Not What They Seem</a></li>
<li><a class="reference internal" href="#the-decision-point-breakpoint-commands">The Decision Point Breakpoint Commands</a></li>
<li><a class="reference internal" href="#actually-using-the-breakpoint-commands">Actually Using The Breakpoint Commands</a></li>
<li><a class="reference internal" href="#sources">Sources</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=d42a975f"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>